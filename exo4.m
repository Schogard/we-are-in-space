Corners = [ 156, 315;283, 297; 339, 270;31, 30]
A=[31, 30]
B=[339, 270]
C=[283, 297]
D=[156, 315]
Width=max(Corners(:, 1))
Height=max(Corners(:, 2))
C1= [
152, 304;
154, 304;
156, 304;
158, 303;
160, 303;
162, 302;
164, 301;
166, 300;
168, 299;
170, 298;
233, 297;
234, 297;
235, 297;
236, 297;
237, 297;
238, 297;
172, 296;
233, 296;
239, 296;
240, 296;
174, 295;
241, 295;
242, 295;
232, 294;
244, 294;
246, 294;
271, 294;
272, 294;
176, 293;
232, 293;
247, 293;
271, 293;
273, 293;
274, 293;
232, 292;
249, 292;
271, 292;
272, 292;
276, 292;
291, 292;
292, 292;
179, 291;
232, 291;
251, 291;
273, 291;
279, 291;
280, 291;
293, 291;
294, 291;
232, 290;
253, 290;
273, 290;
274, 290;
281, 290;
293, 290;
296, 290;
181, 289;
233, 289;
255, 289;
275, 289;
283, 289;
285, 289;
294, 289;
295, 289;
257, 288;
276, 288;
286, 288;
296, 288;
297, 288;
183, 287;
233, 287;
259, 287;
277, 287;
288, 287;
298, 287;
233, 286;
278, 286;
290, 286;
299, 286;
186, 285;
262, 285;
279, 285;
292, 285;
294, 285;
301, 285;
302, 285;
234, 284;
264, 284;
281, 284;
296, 284;
303, 284;
188, 283;
234, 283;
266, 283;
282, 283;
297, 283;
304, 283;
269, 282;
283, 282;
299, 282;
305, 282;
307, 282;
191, 281;
234, 281;
271, 281;
284, 281;
301, 281;
303, 281;
308, 281;
285, 280;
304, 280;
309, 280;
310, 280;
194, 279;
235, 279;
274, 279;
286, 279;
306, 279;
307, 279;
310, 279;
311, 279;
276, 278;
287, 278;
309, 278;
310, 278;
311, 278;
312, 278;
197, 277;
235, 277;
278, 277;
288, 277;
311, 277;
312, 277;
280, 276;
282, 276;
289, 276;
235, 275;
284, 275;
290, 275;
200, 274;
286, 274;
287, 274;
290, 274;
235, 273;
288, 273;
289, 273;
290, 273;
203, 272;
235, 272;
206, 270;
235, 270;
209, 268;
235, 268;
234, 267;
212, 266;
215, 265;
233, 265;
218, 264;
232, 264;
221, 263;
231, 263;
223, 262;
225, 262;
228, 262;
229, 262;
];

X=[0.6198
    2.1242
    3.6690
    5.4844
    7.0863
    8.8942
   10.6802
   12.4447
   14.1880
   15.9106
  104.0531
  106.4364
  108.8727
  111.3637
  113.9115
  116.5178
   17.6016
  101.3869
  115.8437
  118.4452
   19.2527
  117.7371
  120.3334
   94.4583
  122.1834
  127.5424
  223.4021
  228.8538
   20.8147
   92.3064
  126.6392
  214.2557
  224.5444
  229.9355
   90.2709
  128.4096
  205.8856
  210.6080
  230.9863
  337.3715
  346.8552
   23.1304
   88.3425
  130.1449
  207.1607
  237.4476
  243.0620
  336.7530
  346.0465
   86.5130
  131.8462
  199.5170
  203.8976
  238.3794
  318.9813
  345.2675
   24.5422
   86.4894
  133.5144
  200.8044
  239.2853
  250.4286
  310.7563
  318.7201
  135.1506
  197.8682
  245.5885
  310.6392
  318.4676
   25.8911
   83.1527
  136.7556
  195.0773
  246.3845
  310.5259
   81.6018
  192.4212
  247.1590
  303.1070
   27.9858
  137.2930
  189.8904
  247.9127
  258.8746
  303.1150
  310.3101
   80.1953
  138.8180
  191.1501
  259.4818
  303.1229
   29.2106
   78.8005
  140.3152
  188.7333
  254.6390
  296.3802
  144.3427
  186.4241
  255.2768
  290.0420
  303.1378
   31.1767
   76.1879
  145.7780
  184.2156
  255.8982
  266.6739
  296.5871
  182.1013
  261.7543
  290.4185
  296.6862
   33.0826
   75.0983
  146.0416
  180.0753
  262.2864
  267.6263
  284.5995
  290.5991
  147.4110
  178.1322
  268.0844
  273.5143
  279.1013
  284.8523
   34.9309
   72.8184
  148.7569
  176.2670
  268.5309
  273.8979
  150.0797
  155.1357
  174.4751
   70.7107
  156.4173
  172.7522
   36.4255
  157.6770
  160.2580
  168.3055
   68.7565
  158.9153
  161.4859
  164.1057
   38.1445
   67.8317
   39.8146
   66.0779
   41.4378
   64.4411
   62.6729
   43.0161
   44.9457
   60.2896
   46.8770
   58.7076
   48.8102
   57.1897
   49.9426
   51.5557
   54.0363
   54.8799]
Y=[ 235.4162
  236.4741
  237.5604
  232.7019
  233.7451
  228.8740
  224.0619
  219.3077
  214.6105
  209.9692
  238.3092
  239.2171
  240.1451
  241.0940
  242.0644
  243.0572
  200.2717
  228.9020
  233.8420
  234.7310
  195.8528
  225.7854
  226.5745
  211.1660
  218.5826
  220.0162
  245.6593
  247.1176
  186.7750
  203.3869
  211.3645
  231.7232
  234.1139
  235.3666
  196.0285
  203.5963
  218.9699
  219.9070
  223.9507
  245.0607
  246.9425
  178.2549
  189.0574
  195.9820
  208.7398
  213.7569
  214.6869
  230.2069
  231.7464
  182.4439
  188.5170
  197.5827
  198.1696
  202.7890
  213.5870
  217.1085
  169.9376
  176.3382
  181.1970
  188.1497
  192.1257
  193.2770
  199.5103
  200.3332
  174.0178
  178.6383
  182.1539
  186.9462
  187.5229
  161.9909
  164.5654
  166.9754
  169.5976
  171.9044
  174.7882
  159.0931
  160.9935
  161.9322
  162.8916
  154.3828
  153.3109
  152.7952
  152.2262
  152.1187
  151.6849
  151.6143
  148.8304
  146.7234
  144.8425
  142.3865
  140.8179
  147.0660
  144.0262
  140.2556
  137.2877
  133.2478
  130.6892
  133.6845
  130.0695
  124.1547
  121.1682
  120.0432
  139.9694
  135.0272
  127.3863
  123.1659
  115.2952
  114.1121
  110.8276
  116.5568
  105.9622
  102.1497
  101.3160
  133.0904
  126.5543
  115.5181
  110.2237
   97.4346
   96.6039
   93.9635
   93.0302
  109.6024
  104.1497
   88.1840
   87.2202
   86.2286
   85.2078
  126.4193
  118.8866
  103.7887
   98.3192
   79.9755
   78.9085
   98.0743
   96.9641
   92.7179
  111.7980
   91.2489
   87.3325
  117.0870
   85.6315
   84.9619
   82.8742
  105.2254
   80.1094
   79.3933
   78.6635
  110.9392
  102.1152
  104.9665
   96.2169
   99.1615
   90.7120
   88.4751
   93.5171
   90.2725
   83.8965
   87.0248
   81.9274
   83.7741
   80.0382
   80.8899
   80.1471
   79.0049
   78.6164]
plot(X, Y, 'ob');
hold on;
%to find frequency, approximate as a 12deg polyn
[Xsort, index]=sort(X)
Ysort=Y(index)
polyn = polyfit(Xsort,Ysort,12);
plot(Xsort,polyval(polyn,Xsort));

%find the points where the polyn is mean(Y)
polyn(end)=polyn(end)-mean(Y)
sols=roots(polyn)
Xmax=max(X);
sols=sols(find(0<sols & sols<Xmax))
dist=sols(end)-sols(end-1)


hold on;
opts = fitoptions('Method','NonlinearLeastSquares');
ft=fittype('a*sin(b*x+c)+d');
[sortY, index]=sort(Y, 'descend');
freq=dist
opts.StartPoint=[abs((max(Y)-min(Y))/2), pi/abs(freq), Y(1), mean(Y)]
[fitResult, gof, output] = fit(X, Y, ft, opts );
plot(fitResult);
hold off;